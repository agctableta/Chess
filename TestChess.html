<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detector FEN Aislado</title>
    <style>
        body { background: #1a1208; color: #f0d9b5; font-family: sans-serif; text-align: center; padding: 20px; }
        .card { background: #2a2a2a; border: 2px solid #c9a848; padding: 20px; border-radius: 15px; max-width: 500px; margin: auto; }
        #preview { max-width: 100%; margin: 15px 0; display: none; border: 1px solid #c9a848; }
        #fenResult { background: #000; color: #00ff00; padding: 15px; word-break: break-all; font-family: monospace; border-radius: 5px; margin-top: 10px; }
        button { background: #c9a848; color: #1a1208; border: none; padding: 12px 24px; font-weight: bold; border-radius: 5px; cursor: pointer; }
        .loader { color: #e8cc7a; font-style: italic; }
    </style>
</head>
<body>

<div class="card">
    <h2>üì∏ Esc√°ner de Tablero</h2>
    <p>Sube una captura de pantalla clara</p>
    
    <input type="file" id="upload" accept="image/*" style="display:none">
    <button onclick="document.getElementById('upload').click()">SELECCIONAR IMAGEN</button>
    
    <div id="status" class="loader"></div>
    <img id="preview">
    <div id="fenResult">Aqu√≠ aparecer√° el c√≥digo FEN</div>
</div>

<script>
document.getElementById('upload').addEventListener('change', async function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const status = document.getElementById('status');
    const fenResult = document.getElementById('fenResult');
    const preview = document.getElementById('preview');

    // Mostrar preview
    preview.src = URL.createObjectURL(file);
    preview.style.display = 'block';

    status.innerText = "‚è≥ Procesando con Chess-OCR...";
    fenResult.innerText = "---";

    const formData = new FormData();
    formData.append('file', file); // Este servidor usa el campo 'file'

    try {
        // Usamos este servidor que es m√°s libre para desarrolladores
        const response = await fetch('https://worker-chess-ocr.chess-ai.workers.dev/', {
            method: 'POST',
            body: formData
        });

        if (!response.ok) throw new Error("Servidor ocupado");

        const data = await response.json();

        if (data.fen) {
            fenResult.innerText = data.fen;
            status.innerText = "‚úÖ ¬°√âxito!";
        } else {
            status.innerText = "‚ùå No se encontr√≥ un tablero claro";
        }
    } catch (err) {
        console.error(err);
        status.innerText = "‚ùå Error de conexi√≥n";
        fenResult.innerText = "Prueba con otra imagen o espera un momento.";
    }
});
</script>

</body>
</html>
